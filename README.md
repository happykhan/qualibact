# QualiBact

Source code for QualiBact. Analyzing microbial genome assembly statistics across multiple species. It compares allthebacteria assemblies to NCBI RefSeq assemblies and generates detailed statistics, outlier detection with **Isolation Forest**, and visualizations.

Website: https://happykhan.github.io/qualibact/

This is the criteria used in Speccheck: https://github.com/happykhan/speccheck


## üìä Features

- **Genome Assembly Analysis**: Parses genome assembly statistics across multiple species
- **Comparative Analysis**: Compares allthebacteria assemblies to NCBI RefSeq assemblies
- **Outlier Detection**: Uses Isolation Forest and DBSCAN algorithms for anomaly detection
- **Data Visualization**: Generates comprehensive plots and statistics
- **Data Processing**: Includes utilities for merging and processing TSV files
- **Generates**:
  - Histograms with KDE
  - Q-Q plots
  - Joint distribution plots
  - Anomaly score visualizations
  - Summary CSVs for each species

## üöÄ Usage

### Main Analysis Script

```bash
python qualibact-run.py \
    --workdir <working_directory> \
    --species_file <species_file.txt> \
    --min_genome_count <min_count>
```

### Merging TSV Files

The repository includes a utility script `make_copy.sh` for merging multiple TSV files:

```bash
# Merge all TSV files in current directory
./make_copy.sh

# The script combines all .tsv files and adds a filename column to track data source
# Output is saved as merged.tsv
```

## üì§ Output

### Analysis Results
- Per-species plots (`*.png`) and CSV summaries (`summary.csv`, `selected_summary.csv`)
- Combined summary tables across species (`all_metrics.csv`, `all_metrics_summary.csv`)
- Outlier visualizations with anomaly scores and joint KDEs

### Data Processing
- `merged.tsv`: Combined TSV file with filename tracking (generated by `make_copy.sh`)
- GC content analysis results in `output_compare_gc/` directory

## ÔøΩÔ∏è Additional Scripts

- **`make_copy.sh`**: Utility script for merging multiple TSV files with filename tracking
- **`find_failed_jobs.py`**: Helper script for identifying failed processing jobs
- **`gc_refseq/do_gc_refseq.py`**: GC content analysis for RefSeq data

## ÔøΩüì¶ Dependencies

- Python ‚â• 3.7
- pandas
- numpy
- seaborn
- matplotlib
- scipy
- scikit-learn

Install them with:

```bash
pip install -r requirements.txt
```

## üì¨ Contributing

If you find issues or have suggestions, feel free to open an issue or submit a pull request!
